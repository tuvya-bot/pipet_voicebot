{"ast":null,"code":"import { RpcProtocol } from \"@smithy/core/protocols\";\nimport { deref, NormalizedSchema, SCHEMA, TypeRegistry } from \"@smithy/core/schema\";\nimport { calculateBodyLength } from \"@smithy/util-body-length-browser\";\nimport { JsonCodec } from \"./JsonCodec\";\nimport { loadRestJsonErrorCode } from \"./parseJsonBody\";\nexport class AwsJsonRpcProtocol extends RpcProtocol {\n  serializer;\n  deserializer;\n  codec;\n  constructor({\n    defaultNamespace\n  }) {\n    super({\n      defaultNamespace\n    });\n    this.codec = new JsonCodec({\n      timestampFormat: {\n        useTrait: true,\n        default: SCHEMA.TIMESTAMP_EPOCH_SECONDS\n      },\n      jsonName: false\n    });\n    this.serializer = this.codec.createSerializer();\n    this.deserializer = this.codec.createDeserializer();\n  }\n  async serializeRequest(operationSchema, input, context) {\n    const request = await super.serializeRequest(operationSchema, input, context);\n    if (!request.path.endsWith(\"/\")) {\n      request.path += \"/\";\n    }\n    Object.assign(request.headers, {\n      \"content-type\": `application/x-amz-json-${this.getJsonRpcVersion()}`,\n      \"x-amz-target\": (this.getJsonRpcVersion() === \"1.0\" ? `JsonRpc10.` : `JsonProtocol.`) + NormalizedSchema.of(operationSchema).getName()\n    });\n    if (deref(operationSchema.input) === \"unit\" || !request.body) {\n      request.body = \"{}\";\n    }\n    try {\n      request.headers[\"content-length\"] = String(calculateBodyLength(request.body));\n    } catch (e) {}\n    return request;\n  }\n  getPayloadCodec() {\n    return this.codec;\n  }\n  async handleError(operationSchema, context, response, dataObject, metadata) {\n    const errorIdentifier = loadRestJsonErrorCode(response, dataObject) ?? \"Unknown\";\n    let namespace = this.options.defaultNamespace;\n    let errorName = errorIdentifier;\n    if (errorIdentifier.includes(\"#\")) {\n      [namespace, errorName] = errorIdentifier.split(\"#\");\n    }\n    const registry = TypeRegistry.for(namespace);\n    let errorSchema;\n    try {\n      errorSchema = registry.getSchema(errorIdentifier);\n    } catch (e) {\n      const baseExceptionSchema = TypeRegistry.for(\"smithy.ts.sdk.synthetic.\" + namespace).getBaseException();\n      if (baseExceptionSchema) {\n        const ErrorCtor = baseExceptionSchema.ctor;\n        throw Object.assign(new ErrorCtor(errorName), dataObject);\n      }\n      throw new Error(errorName);\n    }\n    const ns = NormalizedSchema.of(errorSchema);\n    const message = dataObject.message ?? dataObject.Message ?? \"Unknown\";\n    const exception = new errorSchema.ctor(message);\n    await this.deserializeHttpMessage(errorSchema, context, response, dataObject);\n    const output = {};\n    for (const [name, member] of ns.structIterator()) {\n      const target = member.getMergedTraits().jsonName ?? name;\n      output[name] = this.codec.createDeserializer().readObject(member, dataObject[target]);\n    }\n    Object.assign(exception, {\n      $metadata: metadata,\n      $response: response,\n      $fault: ns.getMergedTraits().error,\n      message,\n      ...output\n    });\n    throw exception;\n  }\n}","map":{"version":3,"names":["RpcProtocol","deref","NormalizedSchema","SCHEMA","TypeRegistry","calculateBodyLength","JsonCodec","loadRestJsonErrorCode","AwsJsonRpcProtocol","serializer","deserializer","codec","constructor","defaultNamespace","timestampFormat","useTrait","default","TIMESTAMP_EPOCH_SECONDS","jsonName","createSerializer","createDeserializer","serializeRequest","operationSchema","input","context","request","path","endsWith","Object","assign","headers","getJsonRpcVersion","of","getName","body","String","e","getPayloadCodec","handleError","response","dataObject","metadata","errorIdentifier","namespace","options","errorName","includes","split","registry","for","errorSchema","getSchema","baseExceptionSchema","getBaseException","ErrorCtor","ctor","Error","ns","message","Message","exception","deserializeHttpMessage","output","name","member","structIterator","target","getMergedTraits","readObject","$metadata","$response","$fault","error"],"sources":["/Users/tuvyakhatter/Desktop/pipecat_voicebot/~/Desktop/sow_editor/node_modules/@aws-sdk/core/dist-es/submodules/protocols/json/AwsJsonRpcProtocol.js"],"sourcesContent":["import { RpcProtocol } from \"@smithy/core/protocols\";\nimport { deref, NormalizedSchema, SCHEMA, TypeRegistry } from \"@smithy/core/schema\";\nimport { calculateBodyLength } from \"@smithy/util-body-length-browser\";\nimport { JsonCodec } from \"./JsonCodec\";\nimport { loadRestJsonErrorCode } from \"./parseJsonBody\";\nexport class AwsJsonRpcProtocol extends RpcProtocol {\n    serializer;\n    deserializer;\n    codec;\n    constructor({ defaultNamespace }) {\n        super({\n            defaultNamespace,\n        });\n        this.codec = new JsonCodec({\n            timestampFormat: {\n                useTrait: true,\n                default: SCHEMA.TIMESTAMP_EPOCH_SECONDS,\n            },\n            jsonName: false,\n        });\n        this.serializer = this.codec.createSerializer();\n        this.deserializer = this.codec.createDeserializer();\n    }\n    async serializeRequest(operationSchema, input, context) {\n        const request = await super.serializeRequest(operationSchema, input, context);\n        if (!request.path.endsWith(\"/\")) {\n            request.path += \"/\";\n        }\n        Object.assign(request.headers, {\n            \"content-type\": `application/x-amz-json-${this.getJsonRpcVersion()}`,\n            \"x-amz-target\": (this.getJsonRpcVersion() === \"1.0\" ? `JsonRpc10.` : `JsonProtocol.`) +\n                NormalizedSchema.of(operationSchema).getName(),\n        });\n        if (deref(operationSchema.input) === \"unit\" || !request.body) {\n            request.body = \"{}\";\n        }\n        try {\n            request.headers[\"content-length\"] = String(calculateBodyLength(request.body));\n        }\n        catch (e) { }\n        return request;\n    }\n    getPayloadCodec() {\n        return this.codec;\n    }\n    async handleError(operationSchema, context, response, dataObject, metadata) {\n        const errorIdentifier = loadRestJsonErrorCode(response, dataObject) ?? \"Unknown\";\n        let namespace = this.options.defaultNamespace;\n        let errorName = errorIdentifier;\n        if (errorIdentifier.includes(\"#\")) {\n            [namespace, errorName] = errorIdentifier.split(\"#\");\n        }\n        const registry = TypeRegistry.for(namespace);\n        let errorSchema;\n        try {\n            errorSchema = registry.getSchema(errorIdentifier);\n        }\n        catch (e) {\n            const baseExceptionSchema = TypeRegistry.for(\"smithy.ts.sdk.synthetic.\" + namespace).getBaseException();\n            if (baseExceptionSchema) {\n                const ErrorCtor = baseExceptionSchema.ctor;\n                throw Object.assign(new ErrorCtor(errorName), dataObject);\n            }\n            throw new Error(errorName);\n        }\n        const ns = NormalizedSchema.of(errorSchema);\n        const message = dataObject.message ?? dataObject.Message ?? \"Unknown\";\n        const exception = new errorSchema.ctor(message);\n        await this.deserializeHttpMessage(errorSchema, context, response, dataObject);\n        const output = {};\n        for (const [name, member] of ns.structIterator()) {\n            const target = member.getMergedTraits().jsonName ?? name;\n            output[name] = this.codec.createDeserializer().readObject(member, dataObject[target]);\n        }\n        Object.assign(exception, {\n            $metadata: metadata,\n            $response: response,\n            $fault: ns.getMergedTraits().error,\n            message,\n            ...output,\n        });\n        throw exception;\n    }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}