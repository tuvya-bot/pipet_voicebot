{"ast":null,"code":"import { streamCollector } from \"@smithy/fetch-http-handler\";\nimport { toBase64 } from \"@smithy/util-base64\";\nimport { toHex } from \"@smithy/util-hex-encoding\";\nimport { toUtf8 } from \"@smithy/util-utf8\";\nimport { isReadableStream } from \"./stream-type-check\";\nconst ERR_MSG_STREAM_HAS_BEEN_TRANSFORMED = \"The stream has already been transformed.\";\nexport const sdkStreamMixin = stream => {\n  if (!isBlobInstance(stream) && !isReadableStream(stream)) {\n    const name = stream?.__proto__?.constructor?.name || stream;\n    throw new Error(`Unexpected stream implementation, expect Blob or ReadableStream, got ${name}`);\n  }\n  let transformed = false;\n  const transformToByteArray = async () => {\n    if (transformed) {\n      throw new Error(ERR_MSG_STREAM_HAS_BEEN_TRANSFORMED);\n    }\n    transformed = true;\n    return await streamCollector(stream);\n  };\n  const blobToWebStream = blob => {\n    if (typeof blob.stream !== \"function\") {\n      throw new Error(\"Cannot transform payload Blob to web stream. Please make sure the Blob.stream() is polyfilled.\\n\" + \"If you are using React Native, this API is not yet supported, see: https://react-native.canny.io/feature-requests/p/fetch-streaming-body\");\n    }\n    return blob.stream();\n  };\n  return Object.assign(stream, {\n    transformToByteArray: transformToByteArray,\n    transformToString: async encoding => {\n      const buf = await transformToByteArray();\n      if (encoding === \"base64\") {\n        return toBase64(buf);\n      } else if (encoding === \"hex\") {\n        return toHex(buf);\n      } else if (encoding === undefined || encoding === \"utf8\" || encoding === \"utf-8\") {\n        return toUtf8(buf);\n      } else if (typeof TextDecoder === \"function\") {\n        return new TextDecoder(encoding).decode(buf);\n      } else {\n        throw new Error(\"TextDecoder is not available, please make sure polyfill is provided.\");\n      }\n    },\n    transformToWebStream: () => {\n      if (transformed) {\n        throw new Error(ERR_MSG_STREAM_HAS_BEEN_TRANSFORMED);\n      }\n      transformed = true;\n      if (isBlobInstance(stream)) {\n        return blobToWebStream(stream);\n      } else if (isReadableStream(stream)) {\n        return stream;\n      } else {\n        throw new Error(`Cannot transform payload to web stream, got ${stream}`);\n      }\n    }\n  });\n};\nconst isBlobInstance = stream => typeof Blob === \"function\" && stream instanceof Blob;","map":{"version":3,"names":["streamCollector","toBase64","toHex","toUtf8","isReadableStream","ERR_MSG_STREAM_HAS_BEEN_TRANSFORMED","sdkStreamMixin","stream","isBlobInstance","name","__proto__","constructor","Error","transformed","transformToByteArray","blobToWebStream","blob","Object","assign","transformToString","encoding","buf","undefined","TextDecoder","decode","transformToWebStream","Blob"],"sources":["/Users/tuvyakhatter/Desktop/pipecat_voicebot/~/Desktop/sow_editor/node_modules/@smithy/util-stream/dist-es/sdk-stream-mixin.browser.js"],"sourcesContent":["import { streamCollector } from \"@smithy/fetch-http-handler\";\nimport { toBase64 } from \"@smithy/util-base64\";\nimport { toHex } from \"@smithy/util-hex-encoding\";\nimport { toUtf8 } from \"@smithy/util-utf8\";\nimport { isReadableStream } from \"./stream-type-check\";\nconst ERR_MSG_STREAM_HAS_BEEN_TRANSFORMED = \"The stream has already been transformed.\";\nexport const sdkStreamMixin = (stream) => {\n    if (!isBlobInstance(stream) && !isReadableStream(stream)) {\n        const name = stream?.__proto__?.constructor?.name || stream;\n        throw new Error(`Unexpected stream implementation, expect Blob or ReadableStream, got ${name}`);\n    }\n    let transformed = false;\n    const transformToByteArray = async () => {\n        if (transformed) {\n            throw new Error(ERR_MSG_STREAM_HAS_BEEN_TRANSFORMED);\n        }\n        transformed = true;\n        return await streamCollector(stream);\n    };\n    const blobToWebStream = (blob) => {\n        if (typeof blob.stream !== \"function\") {\n            throw new Error(\"Cannot transform payload Blob to web stream. Please make sure the Blob.stream() is polyfilled.\\n\" +\n                \"If you are using React Native, this API is not yet supported, see: https://react-native.canny.io/feature-requests/p/fetch-streaming-body\");\n        }\n        return blob.stream();\n    };\n    return Object.assign(stream, {\n        transformToByteArray: transformToByteArray,\n        transformToString: async (encoding) => {\n            const buf = await transformToByteArray();\n            if (encoding === \"base64\") {\n                return toBase64(buf);\n            }\n            else if (encoding === \"hex\") {\n                return toHex(buf);\n            }\n            else if (encoding === undefined || encoding === \"utf8\" || encoding === \"utf-8\") {\n                return toUtf8(buf);\n            }\n            else if (typeof TextDecoder === \"function\") {\n                return new TextDecoder(encoding).decode(buf);\n            }\n            else {\n                throw new Error(\"TextDecoder is not available, please make sure polyfill is provided.\");\n            }\n        },\n        transformToWebStream: () => {\n            if (transformed) {\n                throw new Error(ERR_MSG_STREAM_HAS_BEEN_TRANSFORMED);\n            }\n            transformed = true;\n            if (isBlobInstance(stream)) {\n                return blobToWebStream(stream);\n            }\n            else if (isReadableStream(stream)) {\n                return stream;\n            }\n            else {\n                throw new Error(`Cannot transform payload to web stream, got ${stream}`);\n            }\n        },\n    });\n};\nconst isBlobInstance = (stream) => typeof Blob === \"function\" && stream instanceof Blob;\n"],"mappings":"AAAA,SAASA,eAAe,QAAQ,4BAA4B;AAC5D,SAASC,QAAQ,QAAQ,qBAAqB;AAC9C,SAASC,KAAK,QAAQ,2BAA2B;AACjD,SAASC,MAAM,QAAQ,mBAAmB;AAC1C,SAASC,gBAAgB,QAAQ,qBAAqB;AACtD,MAAMC,mCAAmC,GAAG,0CAA0C;AACtF,OAAO,MAAMC,cAAc,GAAIC,MAAM,IAAK;EACtC,IAAI,CAACC,cAAc,CAACD,MAAM,CAAC,IAAI,CAACH,gBAAgB,CAACG,MAAM,CAAC,EAAE;IACtD,MAAME,IAAI,GAAGF,MAAM,EAAEG,SAAS,EAAEC,WAAW,EAAEF,IAAI,IAAIF,MAAM;IAC3D,MAAM,IAAIK,KAAK,CAAC,wEAAwEH,IAAI,EAAE,CAAC;EACnG;EACA,IAAII,WAAW,GAAG,KAAK;EACvB,MAAMC,oBAAoB,GAAG,MAAAA,CAAA,KAAY;IACrC,IAAID,WAAW,EAAE;MACb,MAAM,IAAID,KAAK,CAACP,mCAAmC,CAAC;IACxD;IACAQ,WAAW,GAAG,IAAI;IAClB,OAAO,MAAMb,eAAe,CAACO,MAAM,CAAC;EACxC,CAAC;EACD,MAAMQ,eAAe,GAAIC,IAAI,IAAK;IAC9B,IAAI,OAAOA,IAAI,CAACT,MAAM,KAAK,UAAU,EAAE;MACnC,MAAM,IAAIK,KAAK,CAAC,kGAAkG,GAC9G,0IAA0I,CAAC;IACnJ;IACA,OAAOI,IAAI,CAACT,MAAM,CAAC,CAAC;EACxB,CAAC;EACD,OAAOU,MAAM,CAACC,MAAM,CAACX,MAAM,EAAE;IACzBO,oBAAoB,EAAEA,oBAAoB;IAC1CK,iBAAiB,EAAE,MAAOC,QAAQ,IAAK;MACnC,MAAMC,GAAG,GAAG,MAAMP,oBAAoB,CAAC,CAAC;MACxC,IAAIM,QAAQ,KAAK,QAAQ,EAAE;QACvB,OAAOnB,QAAQ,CAACoB,GAAG,CAAC;MACxB,CAAC,MACI,IAAID,QAAQ,KAAK,KAAK,EAAE;QACzB,OAAOlB,KAAK,CAACmB,GAAG,CAAC;MACrB,CAAC,MACI,IAAID,QAAQ,KAAKE,SAAS,IAAIF,QAAQ,KAAK,MAAM,IAAIA,QAAQ,KAAK,OAAO,EAAE;QAC5E,OAAOjB,MAAM,CAACkB,GAAG,CAAC;MACtB,CAAC,MACI,IAAI,OAAOE,WAAW,KAAK,UAAU,EAAE;QACxC,OAAO,IAAIA,WAAW,CAACH,QAAQ,CAAC,CAACI,MAAM,CAACH,GAAG,CAAC;MAChD,CAAC,MACI;QACD,MAAM,IAAIT,KAAK,CAAC,sEAAsE,CAAC;MAC3F;IACJ,CAAC;IACDa,oBAAoB,EAAEA,CAAA,KAAM;MACxB,IAAIZ,WAAW,EAAE;QACb,MAAM,IAAID,KAAK,CAACP,mCAAmC,CAAC;MACxD;MACAQ,WAAW,GAAG,IAAI;MAClB,IAAIL,cAAc,CAACD,MAAM,CAAC,EAAE;QACxB,OAAOQ,eAAe,CAACR,MAAM,CAAC;MAClC,CAAC,MACI,IAAIH,gBAAgB,CAACG,MAAM,CAAC,EAAE;QAC/B,OAAOA,MAAM;MACjB,CAAC,MACI;QACD,MAAM,IAAIK,KAAK,CAAC,+CAA+CL,MAAM,EAAE,CAAC;MAC5E;IACJ;EACJ,CAAC,CAAC;AACN,CAAC;AACD,MAAMC,cAAc,GAAID,MAAM,IAAK,OAAOmB,IAAI,KAAK,UAAU,IAAInB,MAAM,YAAYmB,IAAI","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}